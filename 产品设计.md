# Vectorium (线性代数可视化系统) - 面向 macOS 的 MVP 产品需求文档 (PRD)

## 一、 产品概述与目标

- **产品定位**：面向高校学生与数学爱好者的“交互式线性代数可视化 macOS 原生桌面应用”。
- **核心理念**：
  - 数学对象 = 可交互对象（万物皆可拖动与调整）
  - 推导过程 = 可回溯结构（类似时光机的日志流）
  - 抽象概念 = 可视化变换（用几何直觉解释代数定理）
- **核心目标**：通过极致流畅的 macOS 桌面级渲染性能与精准无误的分数运算体系，打造具有“Ah-ha Moment（顿悟时刻）”的学习体验。在 MVP 阶段剥离复杂度，严格只验证上述三大产品理念。

---

## 二、 macOS 桌面端专属适配规划

为充分利用 Mac M 系列芯片性能与 macOS 的交互习惯，在此重点进行桌面端体验增强：

### 1. 窗口与布局 (Window & Layout)

- **原生多栏布局**：采用经典的 macOS 左中右三栏布局（Navigation Sidebar + Main Canvas + Inspector Panel）。
- **沉浸式全屏**：支持 macOS 原生全屏模式，最大化中央可视化区域（Canvas），在分屏时表现为响应式缩放。
- **半透明材质**：侧边栏与背景板应用 macOS 的 Vibrancy (毛玻璃/模糊底调) 效果，突出主体内容的数学严谨感与现代感。

### 2. 交互与控制 (Keyboard & Trackpad)

- **全局快捷键 (Shortcuts)**：
  - `Cmd + Z` / `Cmd + Shift + Z`：矩阵变换历史的无缝撤销与重做。
  - `Space`：播放/暂停连续的矩阵插值动画。
  - `Cmd + D`：快速复原为单位矩阵或查看目标矩阵对角化状态。
- **触控板增强 (Trackpad Gestures)**：
  - **双指捏合/张开**：无级缩放 2D 坐标系网格平面。
  - **双指滑动**：自由平移坐标系视野，查看越界的向量或变形后的网格。

### 3. 系统级集成 (System Integration)

- **Dark Mode 支持**：跟随系统环境切换至深色/浅色主题。深色模式下网格与色彩需使用高对比度荧光色（如霓虹绿/霓虹粉）强化视觉表现。
- **分享与导出**：顶部菜单栏 (Menu Bar) 支持一键导出当前动画为高质量 GIF，或拷贝当前步骤的 LaTeX 矩阵代码至剪贴板，方便用户在论文或笔记中引用。

---

## 三、 MVP 核心功能需求

根据产品结构规划，第一版仅聚焦于三个最能体现产品核心理念的模块：

### 核心一：二维线性变换可视化 (2D Linear Transformation Visualization)

**功能描述**：直观展示一个 2x2 矩阵对二维空间网格及基向量的线性扭曲变形图景。

- **输入与控制**：
  - 左侧边栏：提供 2x2 矩阵数值输入框，支持实时键盘敲入与通过上下方向键微调数值。
  - 底部控制栏：一个控制 $0\% \to 100\%$ 变换插值进度的平滑动画滑块。
- **可视化呈现**：
  - 基准游标：$i, j$ 基向量（如分别用醒目的红绿箭头表示）在扭曲过程中的动态追踪路径。
  - 空间变形：背景的笛卡尔直角坐标系网格跟随矩阵平顺扭曲成平行四边形网状结构。
  - 面积关联：高亮基向量所围成的平行四边形，以悬浮文本实时显示当前的面积（即行列式的值）。

### 核心二：行变换步骤回放系统 (Row Operation Step Playback System)

**功能描述**：类似于“版本控制”和“操作时光机”，允许对增广矩阵进行无损的初等行变换推演操作。

- **视图与控制**：
  - 左侧面板：初始矩阵录入（支持设置 3x3 常规矩阵或 3x4 增广矩阵）。
  - 中央舞台：当前矩阵状态展现出三种初等行变换快捷操作入口（两行交换，某行乘常数，某行乘系数后加向另一行）。
- **推导记录流 (Inspector)**：
  - 右侧面板：动态推入并显示每一步换算的步骤日志（例如：`R2 = R2 - 2R1`）。
  - 历史穿梭：点击该日志面板里的任意曾经历史节点，中央视图即刻产生平滑降维过渡，时间倒流并呈现至当时步骤的矩阵状态。

### 核心三：特征值与特征向量动画 (Eigenvalue/Eigenvector Animation)

**功能描述**：剥离复杂的计算过程，用视觉直击“线性变换中不改变所在直线方向的向量”这一抽象概念。

- **激活机制**：
  - 在“二维变换可视化模块”中提供显眼的【显示特征向量】开关（Toggle）。
- **动态反应**：
  - 开启后，在网格发生扭曲变形的每一帧动画中，位于特征方向上的基线被特别唤醒并亮起发光。
  - 若为正实数特征值：该方向上的向量箭头在过程中只发生被拉伸/压缩的表现。
  - 若为负实数特征值：呈现向量指向反向反转并拉伸/压缩。
  - 若遇复数特征值（无实特征向量）：针对如纯旋转这类的矩阵，界面将给出旋转涟漪动画式的反馈，直观告知用户此矩阵“无稳固方向保持自身所在的直线上”。

---

## 四、 核心底层技术保障设计 (Math & Core Engine)

为保证 MVP 获得极致丝滑的桌面原生体验与其运算逻辑的严丝合缝，开发需优先具备下层组件：

1. **分数与符号计算核心 (Symbolic Computing Core)**：

- 实现健全的分数封装类（Fraction Structure），应对行变换带来的必定除法。系统渲染出任何数学推导过程时，必须**彻底杜绝浮点数造成的截除偏差**（例如确保绝对呈现 $\frac{1}{3}$，而不允许产生误差值诸如 `0.333333334`）。

2. **2D 图形与几何插值引擎**：

- 脱离 DOM/Web 技术限制，运用 macOS 原生能力（如 Core Graphics / Metal/ SpriteKit 等框架组合）处理大张量网格线的流畅渲染。
- 提供强大的线性缓动插值计算支持（Linear Interpolation Math Engine），使得任意矩阵 A 的形态可极致平滑自然地过渡成目标矩阵 B。

3. **纯净流式的快照链历史机 (Immutable State Snapshot)**：

- 对于每一次矩阵数值操作均生成全新且独立的快照实体（Snapshot），所有“撤销/重做/回溯”本质上变为仅挪动在数组列表里的指针标记点（Cursor），达成极致性能与零隐患错误留存。

---

## 五、 MVP 发版验收基准 (Success Criteria)

1. **如德芙般流畅**：由于所有数值变动和重绘事件触发极其频密，程序各图形面板与文本在最新 macOS 系统的屏幕展示上均须稳定贴附于 60/120 FPS 的刷新率（视屏幕硬件而定），绝不可见明显的帧率跌落。
2. **算数洁癖验证**：完成一场极尽复杂的连续消元或增广矩阵求解战役后，验证终局展现的步骤运算与手动纸笔演算百分百一致，无一出现浮点精度污染。
3. **沉浸式直觉塑造**：将程序全屏幕运作并只用 Trackpad 轻微滑动参数滑块时，能令测试使用者快速从“形变现象”联想至对应的“代数概念原论”，达到应用本身立项的设计初衷。
